<h3>Plugin overview</h3>

<p>
The NP_LMLabels plugin lets you add one or more labels to each item in a blog. 
The normal use for these labels is to categorize items. 
Labels can be used in addition to or instead of the built in category system in Nucleus. 
An other use for this plugin is to add words to the URL of an item.
</p>

<p>
To show the labels associated with an item on an item skin is the plugin template variable used. 
The template variable can be used in any item fields in a template. 
The HTML generated by the template variable used is fully customizable either by plugin options or by template fields.
</p>

<p>
Labels can be used to filter items shown on the index page, archive list page or archive pages of a blog. 
This is done by using the plugin skin variable to add a label cloud to the index, archive list or archive pages. 
All the labels used in the currently available items are shown in the label cloud. 
Each label shown in the label cloud has an URL thats adds the label to the current label filter. 
As labels are added to the label filter will the label cloud change to 
match the items available after filtering. 
The HTML generated by the label cloud skin variable is fully customizable either by plugin options or by template fields.
</p>

<p>
To show the current label filter for an index page, archive list page or archive page is the plugin skin variable used. 
Each label shown in the current label filter has an URL thats removes the label from the filter. 
An URL to remove all labels from the filter is also shown.
The HTML generated by the current label filter skin variable is fully customizable either by plugin options or by template fields.
</p>

<p>
The current skin variables in Nucleus core for showing blog content on index, archive list and archive pages 
does not have the possibility to have plugins filter the items shown.
Because of this the NP_LMLabels plugin uses a helper plugin for handling item filtering. 
This plugin is called NP_LMReplacementVars and gives alternative implementations of some key Nucleus core skin variables.
It must be installed before the NP_LMLabels plugin can be installed. 
The NP_LMReplacementVars plugin can be downloaded from the NP_LMReplacementVars <a href="http://www.slightlysome.net/nucleus-plugins/np_lmreplacementvars">plugin page</a>.
</p>

<p>
The NP_LMLabels plugin uses a helper plugin for handling the URL part values. This plugin is called 
NP_LMURLParts and is used to store and edit the URL part values to be used in the generated URLs. This 
plugin must be installed before the NP_LMLabels plugin can be installed. The NP_LMURLParts plugin can be downloaded from 
the NP_LMURLParts <a href="http://www.slightlysome.net/nucleus-plugins/np_lmurlparts">plugin page</a>.
</p>

<p>
If the NP_LMFancierURL plugin is installed will label keywords be used in URLs. The NP_LMFancierURL plugin can be downloaded from 
the NP_LMFancierURL <a href="http://www.slightlysome.net/nucleus-plugins/np_lmfancierurl">plugin page</a>.
</p>

<h3>Installation</h3>

<ul>
<li>
Before you can install the NP_LMLabels you must install the NP_LMURLParts and NP_LMReplacementVars helper plugins. 
</li>
<li>
Upload the NP_LMLabel.php file and the lmlabels directory from the zip file to the Nucleus CMS plugins directory (nucleus/plugins) on your web server.
</li>
<li>
Go to the Plugins page in the admin area. You should be able to select the plugin in the dropdown list under the "Install New Plugin" section and press the "Install Plugin" button.
</li>
</ul>

<h3>Upgrade</h3>

<ul>
<li>
Take a backup of the current plugin files. You will need these if you want to rollback to the previous version after the upgrade.
</li>
<li>
Take a backup of the database used for you Nucleus installation.
</li>
<li>
Replace the old plugin files with the new ones. Do not uninstall the plugin.
</li>
<li>
If a plugin data upgrade is needed, will an upgrade plugin data option be 
available on the NP_LMLabels plugin admin page. Choose this option to upgrade the plugin data.
</li>
<li>

After the plugin data upgrade has been performed may a rollback option and a commit option be available on the NP_LMLabels 
plugin admin page. Not all upgrades support the rollback and commit option.
</li>
<li>
If you are not pleased with the new version of the plugin you may use the rollback option to rollback the plugin data upgrade. 
After the rollback of the plugin data upgrade you have to replace the new plugin files with the old plugin files.
</li>
<li>
If you are pleased with the new version of the plugin you should use the commit option to commit the plugin data upgrade. 
After the commit of the plugin data upgrade will any rollback and commit options disappear.
</li>
</ul>


<h3>Configuration</h3>

<p>
The NP_LMLabels plugin has the following options on the global level:
</p>

<ul>
<li>
<b>Delete NP_LMLabels data on uninstall?</b> - Choose if all data should be deleted when the plugin is uninstalled.
</li>
<li>
<b>Include marked labels in URLs for items?</b> - Choose if any marked labels should be included in item URLs. 
See the usage section for more information on how to mark labels. Requires NP_LMFancierURL plugin installed if set to Yes.
</li>

<li>
<b>Item Labels</b> - Template for how to put together the label list generated by the <code>&lt;%LMLabels()%&gt;</code> template variable with the <code>ItemLabels</code> function. 
This template variable is meant to be used in the item section of a Nucleus template.
The <b>Item Labels</b> template is build up by the following variables:
<ul>
<li>
<b><code>&lt;%header%&gt;</code></b> - Inserts the content of the <b>Item Labels Header</b> option or template field. 
</li>
<li>
<b><code>&lt;%body%&gt;</code></b> - Inserts the content of the <b>Item Labels Body</b> and <b>Item Labels Body Last</b> options or template fields. 
The content of <b>Item Labels body</b> is inserted for each label associated with the item except the the last label. 
For the last label is the content of <b>Item Labels Body Last</b> inserted.
If there are no labels associated with the item, will nothing be inserted. 
</li>
<li>
<b><code>&lt;%none%&gt;</code></b> - Inserts the content of the <b>Item Labels None</b> option or template field if no labels are associated with the item.
</li>
<li>
<b><code>&lt;%footer%&gt;</code></b> - Inserts the content of the <b>Item Labels Footer</b> option or template field.
</li>
</ul>
</li>

<li>
<b>Item Labels Header</b> - The following variables are available: <code>&lt;%contexturl%&gt;</code> 
(URL to index or archive with an empty label filter).
</li>
<li>
<b>Item Labels Body</b> - The following variables are available: <code>&lt;%contexturl%&gt;</code> 
(URL to index or archive with the label added to the label filter) and <code>&lt;%labelname%&gt;</code>.
</li>
<li>
<b>Item Labels Body Last</b> - The following variables are available: <code>&lt;%contexturl%&gt;</code> 
(URL to index or archive with the label added to the label filter) and <code>&lt;%labelname%&gt;</code>.
</li>
<li>
<b>Item Labels None</b> - The following variables are available: <code>&lt;%contexturl%&gt;</code> 
(URL to index or archive with an empty label filter).
</li>
<li>
<b>Item Labels Footer</b> - The following variables are available: <code>&lt;%contexturl%&gt;</code> 
(URL to index or archive with an empty label filter).
</li>

<li>
<b>Current Labels</b> - Template for how to put together the label list generated by the <code>&lt;%LMLabels()%&gt;</code> skin variable with the <code>CurrentLabels</code> function.
This variable is meant to be used in index, archive list and archive skins to show and manipulate the labels in the current label filter.
The <b>Current Labels</b> template is build up by the following variables:
<ul>
<li>
<b><code>&lt;%header%&gt;</code></b> - Inserts the content of the <b>Current Labels Header</b> option or template field. 
</li>
<li>
<b><code>&lt;%body%&gt;</code></b> - Inserts the content of the <b>Current Labels Body</b> and <b>Current Labels Body Last</b> options or template fields. 
The content of <b>Current Labels body</b> is inserted for each label in the current label filter except the the last label. 
For the last label is the content of <b>Current Labels Body Last</b> inserted.
If there are no labels in the current label filter, will nothing be inserted. 
</li>
<li>
<b><code>&lt;%clear%&gt;</code></b> - Inserts the content of the <b>Current Labels Clear</b> option or template field if one or more labels is in the current label filter.
</li>
<li>
<b><code>&lt;%none%&gt;</code></b> - Inserts the content of the <b>Current Labels None</b> option or template field if no labels are in the current label filter.
</li>
<li>
<b><code>&lt;%footer%&gt;</code></b> - Inserts the content of the <b>Current Labels Footer</b> option or template field.
</li>
</ul>
</li>

<li>
<b>Current Labels Header</b> - The following variables are available: <code>&lt;%contexturl%&gt;</code> 
(URL to index, archive list or archive with an empty label filter).
</li>
<li>
<b>Current Labels Body</b> - The following variables are available: <code>&lt;%contexturl%&gt;</code> 
(URL to index, archive list or archive with the label removed from the label filter) and <code>&lt;%labelname%&gt;</code>.
</li>
<li>
<b>Current Labels Body Last</b> - The following variables are available: <code>&lt;%contexturl%&gt;</code> 
(URL to index, archive list or archive with the label removed from the label filter) and <code>&lt;%labelname%&gt;</code>.
</li>
<li>
<b>Current Labels Clear</b> - The following variables are available: <code>&lt;%contexturl%&gt;</code> 
(URL to index, archive list or archive with an empty label filter).
</li>
<li>
<b>Current Labels None</b> - The following variables are available: <code>&lt;%contexturl%&gt;</code> 
(URL to index, archive list or archive with an empty label filter).
</li>
<li>
<b>Current Labels Footer</b> - The following variables are available: <code>&lt;%contexturl%&gt;</code> 
(URL to index, archive list or archive with an empty label filter).
</li>

<li>
<b>Cloud Labels</b> - Template for how to put together the label list generated by the <code>&lt;%LMLabels()%&gt;</code> skin variable with the <code>CloudLabels</code> function.
This variable is meant to be used in index, archive list and archive skins to show a label cloud which includes the labels in the available items. 
The label cloud can be used to manipulate the labels in the current label filter.
The <b>Cloud Labels</b> template is build up by the following variables:
<ul>
<li>
<b><code>&lt;%header%&gt;</code></b> - Inserts the content of the <b>Cloud Labels Header</b> option or template field. 
</li>
<li>
<b><code>&lt;%body%&gt;</code></b> - Inserts the content of the <b>Cloud Labels Body</b> and <b>Cloud Labels Body Last</b> options or template fields. 
The content of <b>Cloud Labels body</b> is inserted for each label in the cloud except the the last label. 
For the last label is the content of <b>Cloud Labels Body Last</b> inserted.
If there are no labels in the label cloud, will nothing be inserted. 
</li>
<li>
<b><code>&lt;%none%&gt;</code></b> - Inserts the content of the <b>Cloud Labels None</b> option or template field if no labels are in the label cloud.
</li>
<li>
<b><code>&lt;%footer%&gt;</code></b> - Inserts the content of the <b>Cloud Labels Footer</b> option or template field.
</li>
</ul>
</li>

<li>
<b>Cloud Labels Header</b> - The following variables are available: <code>&lt;%contexturl%&gt;</code> 
(URL to index, archive list or archive with an empty label filter).
</li>
<li>
<b>Cloud Labels Body</b> - The following variables are available: <code>&lt;%contexturl%&gt;</code> 
(URL to index, archive list or archive with the label added to the label filter), <code>&lt;%labelname%&gt;</code>, 
<code>&lt;%count%&gt;</code> (The number of available items where the label is used) and <code>&lt;%size%&gt;</code> 
(Size to be used on label in the cloud: <code>small</code>, <code>medium</code>, <code>large</code> and <code>xlarge</code>).
</li>
<li>
<b>Cloud Labels Body Last</b> - The following variables are available: <code>&lt;%contexturl%&gt;</code> 
(URL to index, archive list or archive with the label added to the label filter), <code>&lt;%labelname%&gt;</code>, 
<code>&lt;%count%&gt;</code> (The number of available items where the label is used) and <code>&lt;%size%&gt;</code>
(Size to be used on label in the cloud: <code>small</code>, <code>medium</code>, <code>large</code> and <code>xlarge</code>).
</li>
<li>
<b>Cloud Labels None</b> - The following variables are available: <code>&lt;%contexturl%&gt;</code> 
(URL to index, archive list or archive with an empty label filter).
</li>
<li>
<b>Cloud Labels Footer</b> - The following variables are available: <code>&lt;%contexturl%&gt;</code> 
(URL to index, archive list or archive with an empty label filter).
</li>
</ul>

<p>
The NP_LMLabels plugin has the following options on the blog level.
The default value for the blog options is to use the value of the globally defined options. 
See the global options description for a description of the options values. Available blog options are:
</p>

<ul>
<li>
<b>Include marked labels in URLs for items?</b> - Choose if any marked labels should be included in item URLs.
</li>
</ul>

<p>
The NP_LMLabels plugin has fields that can be set in Nucleus templates. 
These fields can be used to override the value of the plugin option with the same names. 
The purpose of the plugin template fields is to be able do differentiate the layout 
by the different NP_LMLabels plugin variables on a Nucleus site by specifying a Nucleus template as a parameter to the plugin variable.
The default value for the template fields (when empty) is to use the value of the corresponding plugin option. 
If you want to force a template field to produce a empty string add the value <code>#empty#</code> to the Nucleus template field.
</p>

<h3>Usage</h3>

<p>
Labels for an item are registered on the Add Item page, and can be updated on the Edit Item page. 
The field for the labels is in the Extra Plugin Options section.
</p>

<p>
The labels for an item are registered as a comma separated list. 
Label names can have spaces, but any spaces are trimmed from the begining and end of a label.
If labels are prepended with a *, will the label be marked for inclusion in generated item URLs. 
For any inclusion to be performed must inclusion also be turned on in plugin or blog options. 
The * is not included in the label. If you need a label to start with a *, prepend the label with a '.
</p>

<p>
If you want to change the name of a label, is it best to use the NP_LMLabels plugin admin page. 
When you use the NP_LMLabels plugin admin page to change a label name, 
will you change the label name for all items that the label is associated with.
</p>

<p>
You can also use the NP_LMURLParts plugin admin page to edit the label URL part keywords that NP_LMFancierURL should use.
See the NP_LMURLPart plugin help page for more information on using the NP_LMURLParts plugin admin page. 
</p>

<p>
To be able to display labels in your blog you need to use the skin and template variable for this plugin. 
The first parameter for the skin and template variable is always the function to perform.
For some of the functions is it defined dynamic parameters. Dynamic parameters are given like <code>parametername=parametervalue</code>. 
If more than one dynamic parameter are used, must they be comma separated.
The available functions are listed in the following sections.
</p>

<h3>ItemLabels</h3>

<p>
Inserts the labels associated with an item. Is used in the item part of an Nuclues template.
Uses the template defined in the <b>Item Labels</b> plugin option or Nucleus template field. 
</p>
<pre>&lt;%LMLabels(ItemLabels, template)%&gt;</pre>
<p>
The parameters are:
</p>
<ul>
<li>
<b>template</b> - Name of the template to use (can be blank).
</li>
</ul>

<h3>CurrentLabels</h3>

<p>
Inserts the labels in the current label filter. Is used in index, archive list and archive pages.
Uses the template defined in the <b>Current Labels</b> plugin option or Nucleus template field. 
</p>
<pre>&lt;%LMLabels(CurrentLabels, template)%&gt;</pre>
<p>
The parameters are:
</p>
<ul>
<li>
<b>template</b> - Name of the template to use (can be blank).
</li>
</ul>

<h3>CloudLabels</h3>

<p>
Inserts a label cloud. Is used in index, archive list and archive pages.
Uses the template defined in the <b>Cloud Labels</b> plugin option or Nucleus template field. 
</p>
<pre>&lt;%LMLabels(CloudLabels, template, dynamic parameters)%&gt;</pre>
<p>
The parameters are:
</p>
<ul>
<li>
<b>template</b> - Name of the template to use (can be blank).
</li>
<li>
<b>mediumpercent</b> - The limit in percent of the available labels to start using the medium label size, default value: 50 (optional, dynamic).
</li>
<li>
<b>largepercent</b> - The limit in percent of the available labels to start using the large label size, default value: 80 (optional, dynamic).
</li>
<li>
<b>xlargepercent</b> - The limit in percent of the available labels to start using the xlarge label size, default value: 95 (optional, dynamic).
</li>
</ul>

<p>
When the plugin assigns size to a label is the labels sorted by usage count. 
The labels with the lowest usage count gets the small size, and up to the labels whith the highest usage count get the xlarge size. 
How many labels that get each size is determined by the <b>mediumpercent</b>, <b>largepercent</b> and <b>xlargepercent</b> parameters. 
When there are few labels in the label cloud, may some of the sizes not be used.
</p>

<p>
Example use: 
</p>

<pre>
&lt;%LMLabels(CloudLabels, lm/index)%&gt;
&lt;%LMLabels(CloudLabels, lm/index, mediumpercent=55, largepercent=75, xlargepercent=90)%&gt;
&lt;%LMLabels(CloudLabels, lm/index, xlargepercent=87)%&gt;
</pre>

<p>
Example CSS to set the size of labelnames in a label cloud when using the default values for the <b>Cloud Labels Body</b> and <b>Cloud Labels Body Last</b> options.
</p>

<pre>.lmlabelscloudsmall {
	font-size: 10px;
}

.lmlabelscloudmedium {
	font-size: 11px;
}

.lmlabelscloudlarge {
	font-size: 12px;
}

.lmlabelscloudxlarge {
	font-size: 14px;
	font-weight: bold;
}</pre>

<h3>MetaNoIndex</h3>

<p>
Inserts a <code>noindex</code> meta tag on index, archive list 
and archive page if the items on the page is filtered by a label filter or a choosen category. 
Will also set the <code>noindex</code> meta tag on search results pages. 
The skinvar must be used in the <code>head</code> part of the page.
</p>
<pre>&lt;%LMLabels(MetaNoIndex)%&gt;</pre>
<p>
There are no parameters for this function.
</p>
<p>
The text inserted is:
</p>
<pre>&lt;meta name=&quot;robots&quot; content=&quot;noindex&quot; /&gt;</pre>

<p>
The purpose of the <b>MetaNoIndex</b> skinvar function is to avoid that search engines indexes pages that contain filtered content. 
You don't need to get filtered pages indexed, because all the content is available from the unfiltered pages. 
You may also add the <code>rel="nofollow"</code> attribute to all URLs that points to filtered content.
</p>

<h3>NP_LMReplacementVars</h3>

<p>
The replacement skin variables in the NP_LMReplacementVars plugin must be used by your blog if you want the current label filter to function.
This includes all replacement skinvars for archive, archiveList, archivedaylist, archiveyearlist, blog and categorylist. 
See the documentation for the NP_LMReplacementVars plugin for further information on how to use the replacement skinvars.
</p>

<p>
The NP_LMLabels plugin recognize the following dynamic parameter used by the NP_LMReplacementVars replacement for the 
archive, archivelist, archivedaylist, archiveyearlist and blog skin variables:
</p>

<ul>
<li>
<b>lmlabelsfilter</b> - When set to <code>disable</code> will the current label filter be disabled for this skin variable.
</li>
</ul>

<h3>Support and Bug reports</h3>

<p>
For additional support and/or bug reports please use the Nucleus forum 
<a href="http://forum.nucleuscms.org/viewtopic.php?t=21067"">plugin announce thread</a> 
or the <a href="http://www.slightlysome.net/nucleus-plugins/np_lmlabels">plugin page</a> comment section.
</p>


<h3>Compability</h3>

<p>
This version of the NP_LMLabels is tested against version 3.64 of Nucleus CMS. 
The minimum version of Nucleus CMS needed for using this plugin is 3.50,
the minimum version of the NP_LMURLParts plugin needed by this plugin is version 1.1.1
and the minimum version of the NP_LMReplacementVars plugin needed by this plugin is version 1.0.0. 
If the NP_LMFancierURL plugin is installed is the minimum version of the NP_LMFancierURL plugin needed by this plugin version 3.0.0.
</p>

<h3>Version History</h3>

<ul>
<li><b>v1.0.0 2013-01-27:</b> by Leo (http://www.slightlysome.net)</li>
<ul>
<li>Initial release.</li>
</ul>
<li><b>v1.0.1 2013-05-20:</b> by Leo (http://www.slightlysome.net)</li>
<ul>
<li>Changes for PHP 5.4.</li>
</ul>
</ul>

<h3>Download</h3>

<p>
<a href="http://www.slightlysome.net/download/NP_LMLabels_v101.zip" title="Download NP_LMLabels_v101.zip">Download NP_LMLabels v1.0.1</a>. 
The latest version of the NP_LMLabels plugin can be downloaded from the NP_LMLabels <a href="http://www.slightlysome.net/nucleus-plugins/np_lmlabels">plugin page</a>.
</p>
<p>
The latest version of the NP_LMReplacementVars plugin can be downloaded from the NP_LMReplacementVars <a href="http://www.slightlysome.net/nucleus-plugins/np_lmreplacementvars">plugin page</a>.
</p>
<p>
The latest version of the NP_LMURLParts plugin can be downloaded from the NP_LMURLParts <a href="http://www.slightlysome.net/nucleus-plugins/np_lmurlparts">plugin page</a>.
</p>
